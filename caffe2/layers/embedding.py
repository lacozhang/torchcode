from caffe2.python import (    schema,)from caffe2.python.layers import layersimport numpy as npclass Embedding(layers.ModelLayer):    def __init__(self, model, input_record, vocab_size, embed_size, name='embed_layer', **kwargs):        super(Embedding, self).__init__(model, name, input_record, **kwargs)                assert isinstance(input_record, schema.Scalar), "Incorrect input type"                input_dims = input_record.field_type().shape                        self.embed = self.create_param(            param_name="embedding_table",            shape=(vocab_size, embed_size),            initializer=('XavierFill', {}),            optimizer=None        )                        self.output_schema = schema.Scalar(            (np.float32, input_dims + (embed_size,)),            self.get_next_blob_reference('output')        )            def add_ops(self, net):        net.Gather(            [self.embed] + self.input_record.field_blobs(),            self.output_schema.field_blobs(),        )